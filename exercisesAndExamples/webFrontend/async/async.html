<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js async/await</title>
</head>

<body>
</body>

<script type="text/javascript">
    /*

    运行，然后看每一个console.info打印出的是什么

    可以修改其中一个步骤为reject

    */

    var i = 0;

    let p1 = (i) => {
        return new Promise((resolve, reject) => {
            setTimeout(() => {
                i += 1;
                resolve(i);
            }, 1000);
        });
    };

    let p2 = (i) => {
        return new Promise((resolve, reject) => {
            setTimeout(() => {
                i += 1;
                resolve(i);
            }, 1000);
        });
    };

    let p3 = (i) => {
        return new Promise((resolve, reject) => {
            setTimeout(() => {
                i += 1;
                resolve(i);
            }, 1000);
        });
    };

    (async function (){
        try {
            let n = await p1(i);
            n = await p2(n);
            n = await p3(n);
            console.info(n);
            (async () => {
                let n = await p1(i);
                n = await p2(n);
                n = await p3(n);
                console.info(n);
            })();
        } catch (e){
            console.error(e);
        }
    })();
</script>
</html>
